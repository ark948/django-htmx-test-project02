{% load widget_tweaks %}
{% load ir_date %}

<!-- the Grid container -->
<div class="flex flex-col-reverse md:grid md:grid-cols-4 md:gap-4">
    <!-- 3/4 cols for table -->
    <div class="col-span-3">
        <div class="overflow-x-auto rounded-box border border-base-content/5 bg-base-200">
            <table class="table table-md">
                <thead>
                    <tr>
                        <th></th>
                        <th>First Name</th>
                        <th>Last Name</th>
                        <th>Email</th>
                        <th>Phone Number</th>
                        <th>Address</th>
                        <th>Created at:</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in filter.qs %}
                        <tr class="hover:bg-base-300">
                            <th>{{ forloop.counter }}</th>
                            <td>{{ item.first_name }}</td>
                            <td>{{ item.last_name }}</td>
                            <td>{{ item.email }}</td>
                            <td>{{ item.phone_number }}</td>
                            <td>{{ item.address }}</td>
                            <td>{{ item.created_at|to_persian }}</td>
                            <td><a class="link link-hover" 
                                    hx-get="{% url 'contacts:item-detail' pk=item.id %}"
                                    hx-trigger="click"
                                    hx-target="#data_to_replace"
                                    hx-on:success="item_modal.showModal();">
                                View
                                </a>
                            </td>
                            <td>
                                <button 
                                    class="btn btn-soft btn-primary btn-sm"
                                    hx-get="{% url 'contacts:item-edit' pk=item.id %}"
                                    hx-trigger="click"
                                    hx-target="#edit_data_to_replace"
                                    hx-on:success="item_edit_modal.showModal();">
                                    Edit
                                </button>
                            </td>
                            <td>
                                <button 
                                    class="btn btn-soft btn-error btn-sm"
                                    hx-delete="{% url 'contacts:delete' pk=item.id %}"
                                    hx-trigger="click"
                                    hx-target="#contacts_container">
                                    Delete
                                </button>
                            </td>
                        </tr>
                    {% endfor %}
                </tbody>
                <tfoot>
                </tfoot>
            </table>
            {% include 'contacts/partials/contact-new-item-modal.html' %}
        </div>
    </div>

    
    <!-- 1/4 cols for filter form -->
    <div class="col-span-1">
        <div id="filter_form">
            <h4 class="font-bold text-md text-black-400">
                Filters
            </h4>
            <form 
                method="GET"
                action="{% url 'contacts:list' %}"
                class="m-4">
                <div class="form-control">
                    {{ filter.form.first_name|add_label_class:"label text-black" }}
                    {% render_field filter.form.first_name class="input" %}
                </div>
                <div class="form-control">
                    {{ filter.form.last_name|add_label_class:"label text-black" }}
                    {% render_field filter.form.last_name class="input" %}
                </div>
                <div class="form-control">
                    {{ filter.form.email|add_label_class:"label text-black" }}
                    {% render_field filter.form.email class="input" %}
                </div>
                <div class="form-control">
                    {{ filter.form.phone_number|add_label_class:"label text-black" }}
                    {% render_field filter.form.phone_number class="input" %}
                </div>
                <button class="btn btn-md btn-dash mt-1">
                    Apply
                </button>
                <button class="btn btn-primary btn-outline btn-sm"
                    hx-get="{% url 'contacts:list' %}"
                    hx-target="#contacts_container"
                    hx-push-url="true"
                    hx-on:clean="console.log('Refreshing list...')">
                    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z" />
                    </svg>                                         
                Clear
            </button>
            </form>
        </div>
    </div>
</div>